
WITH ZONG AS
(
SELECT TIME_DAY,COUNT(1) AS PV FROM EDW_USER_WEB_LOG
WHERE 1=1
${queryCond}
GROUP BY TIME_DAY ORDER BY TIME_DAY DESC
),
QUCHONG AS (
SELECT TIME_DAY,COUNT(DISTINCT UUID) AS UV FROM EDW_USER_WEB_LOG
WHERE 1=1
${queryCond}
GROUP BY TIME_DAY ORDER BY TIME_DAY DESC
),
zuizhong as (
SELECT 
 T.TIME_DAY,
 T.PV,
 Q.UV
 FROM ZONG T
 LEFT JOIN QUCHONG Q
 ON  T.TIME_DAY=Q.TIME_DAY
 ORDER BY T.TIME_DAY DESC
 )
 select 
 to_char(TIME_DAY) as TIME_DAY,
 PV,
 uv
  from zuizhong  
union all
SELECT 
 '汇总',
 sum(a.PV),
 sum(a.UV)
 FROM zuizhong a

